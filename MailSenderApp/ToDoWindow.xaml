<Window x:Class="MailSenderApp.ToDoWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Cahier des Charges - To-Do List" Height="600" Width="700"
        WindowStartupLocation="CenterScreen">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Titre -->
        <TextBlock Grid.Row="0" Text="To-Do List" 
                   FontSize="24" FontWeight="Bold" 
                   HorizontalAlignment="Center" Margin="0,0,0,20"/>

        <!-- Zone d'ajout de tâche -->
        <Grid Grid.Row="1" Margin="0,0,0,20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <TextBox x:Name="txtNewTask" Grid.Column="0" 
                     Height="35" FontSize="14"
                     VerticalContentAlignment="Center"
                     Text="{Binding NewTaskText, UpdateSourceTrigger=PropertyChanged}"
                     KeyDown="txtNewTask_KeyDown"
                     ToolTip="Entrez une nouvelle tâche et appuyez sur Entrée ou cliquez sur Ajouter"/>

            <Button x:Name="btnAdd" Grid.Column="1" 
                    Content="➕ Ajouter" 
                    Width="120" Height="35" Margin="10,0,0,0"
                    FontSize="14" FontWeight="Bold"
                    Background="#4CAF50" Foreground="White"
                    Click="btnAdd_Click" Cursor="Hand"/>
        </Grid>

        <!-- Liste des tâches -->
        <Border Grid.Row="2" BorderBrush="#CCCCCC" BorderThickness="1" 
                CornerRadius="5" Padding="10">
            <ListBox x:Name="lstTasks" 
                     ScrollViewer.VerticalScrollBarVisibility="Auto"
                     SelectionMode="Single">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Grid Margin="5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <!-- CheckBox pour marquer comme fait -->
                            <CheckBox Grid.Column="0" 
                                      IsChecked="{Binding IsDone, Mode=TwoWay}"
                                      VerticalAlignment="Center"
                                      Margin="0,0,10,0"
                                      Checked="CheckBox_Changed"
                                      Unchecked="CheckBox_Changed"/>

                            <!-- Titre de la tâche -->
                            <TextBlock Grid.Column="1" 
                                       Text="{Binding Title}"
                                       FontSize="14"
                                       VerticalAlignment="Center"
                                       TextWrapping="Wrap">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsDone}" Value="True">
                                                <Setter Property="TextDecorations" Value="Strikethrough"/>
                                                <Setter Property="Foreground" Value="Gray"/>
                                                <Setter Property="FontStyle" Value="Italic"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>

                            <!-- Bouton Supprimer -->
                            <Button Grid.Column="2" 
                                    Content="🗑️" 
                                    Width="30" Height="30"
                                    FontSize="14"
                                    Background="#F44336" Foreground="White"
                                    Click="btnDelete_Click"
                                    Tag="{Binding}"
                                    Cursor="Hand"
                                    ToolTip="Supprimer cette tâche"/>
                        </Grid>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </Border>

        <!-- Barre d'actions -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" 
                    HorizontalAlignment="Center" Margin="0,20,0,0">

            <TextBlock x:Name="txtTaskCount" 
                       Text="0 tâche(s)" 
                       FontSize="14" FontWeight="Bold"
                       VerticalAlignment="Center"
                       Margin="0,0,20,0"/>

            <Button Content="Supprimer les tâches terminées" 
                    Width="220" Height="35"
                    FontSize="12"
                    Background="#FF9800" Foreground="White"
                    Click="btnClearCompleted_Click" Cursor="Hand"/>
        </StackPanel>
    </Grid>
</Window>